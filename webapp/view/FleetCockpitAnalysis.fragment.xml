<core:FragmentDefinition xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:f="sap.ui.layout.form">

    <Dialog id="fleetCockpitDialog" contentWidth="80%" contentHeight="70%" draggable="true" resizable="true" title="{= (${OrdersD>/isEdit} ? 'Plan &amp; Assign' : 'Create') + ' Shipment'}" class="sapUiResponsivePadding--content">

        <content>
            <VBox width="100%" class="sapUiSmallMargin">
                <VBox class="formBox sapUiMediumMarginTop">
                    <HBox alignItems="Center" class="sapUiSmallMarginBottom">
                        <Title text="Select Business Unit &amp; Product Type" level="H4"/>
                    </HBox>

                    <f:SimpleForm backgroundDesign="Transparent" editable="true" layout="ColumnLayout" columnsXL="3" columnsL="3" columnsM="3">
                        <f:content>
                            <Label text="à¸«à¸™à¹ˆà¸§à¸¢à¸‡à¸²à¸™ (Business Unit)" required="true"/>
                            <ComboBox placeholder="-Select BU-" value="{OrdersD>/editData/bu}" width="100%" items="{OrdersD>/sections/0/fields/0/options}">
                                <items>
                                    <core:Item key="{OrdersD>}" text="{OrdersD>}"/>
                                </items>
                            </ComboBox>

                            <Label text="à¸Šà¸™à¸´à¸”à¸ªà¸´à¸™à¸„à¹‰à¸² (Product Type)"/>
                            <ComboBox items="{OrdersD>/sections/0/fields/1/options}" value="{OrdersD>/editData/productType}" placeholder="â€” Select Product â€”" width="100%">
                                <items>
                                    <core:Item key="{OrdersD>}" text="{OrdersD>}"/>
                                </items>
                            </ComboBox>

                            <Label text="Site (Optional)" required="true"/>
                            <ComboBox width="100%" placeholder="All Sites" value="{OrdersD>/editData/site}" items="{OrdersD>/sections/0/fields/2/options}">
                                <items>
                                    <core:Item key="{OrdersD>}" text="{OrdersD>}"/>
                                </items>
                            </ComboBox>

                            <Label text="Route" visible="{OrdersD>/isEdit}"/>
                            <Input value="010005" visible="{= ${OrdersD>/isEdit}}" editable="false" />

                            <Label text="Customer" visible="{OrdersD>/isEdit}"/>
                            <Input value="à¹„à¸—à¸¢à¹€à¸šà¸Ÿ (à¸šà¸²à¸‡à¸šà¸²à¸¥)" visible="{= ${OrdersD>/isEdit}}"  editable="false" />

                            <Label text="Ship-To" visible="{OrdersD>/isEdit}"/>
                            <Input value="010025" visible="{= ${OrdersD>/isEdit}}" editable="false" />

                            <Label text="Quantity" visible="{OrdersD>/isEdit}"/>
                            <Input value="15,000 kg" visible="{= ${OrdersD>/isEdit}}" editable="false" />

                            <Label text="Planned Date" visible="{OrdersD>/isEdit}"/>
                            <Input value="05.02.2026" visible="{= ${OrdersD>/isEdit}}" editable="false" />

                            <Label text="Contract/WBS" visible="{OrdersD>/isEdit}"/>
                            <Input value="08S.26CF.BPK.001" visible="{= ${OrdersD>/isEdit}}" editable="false" />

                            <Label text="Status" visible="{OrdersD>/isEdit}" />
                            <ObjectStatus text="Approved" state="Success" visible="{OrdersD>/isEdit}" />

                        </f:content>
                    </f:SimpleForm>
                </VBox>

                <VBox visible="{OrdersD>/isEdit}" class="formBox sapUiMediumMarginTop">
                    <HBox alignItems="Center" justifyContent="SpaceBetween" class="sapUiSmallMarginBottom">
                        <items>
                            <Title text="Add More Freight Orders (Same Route)" level="H4"/>
                            <ObjectStatus id="addedFOCountBadge" text="0 Added" state="Information" inverted="true" />
                        </items>
                    </HBox>

                    <MessageStrip text="Consolidate multiple FOs into one shipment. When route changes, matching FOs will refresh." type="Information" showIcon="true" class="sapUiSmallMarginBottom" />

                    <Table id="matchingFOTable" inset="false" mode="MultiSelect" selectionChange=".onFOToggle" sticky="ColumnHeaders">
                        <headerToolbar>
                            <OverflowToolbar>
                                <content>
                                    <Label text="Matching FOs for Route:" />
                                    <Title id="matchingRouteLabel" text="BPK-NKC" level="H5" />
                                    <ToolbarSpacer />
                                    <Button icon="sap-icon://refresh" text="Refresh" press=".onRefreshMatchingFOs" />
                                </content>
                            </OverflowToolbar>
                        </headerToolbar>
                        <columns>
                            <Column>
                                <Text text="FO No." />
                            </Column>
                            <Column>
                                <Text text="Customer" />
                            </Column>
                            <Column>
                                <Text text="Ship-To" />
                            </Column>
                            <Column hAlign="End">
                                <Text text="Quantity" />
                            </Column>
                        </columns>
                        <items>
                            <ColumnListItem>
                                <cells>
                                    <Text text="FO-2026-0002" class="sapUiTinyMarginTop sapUiTinyMarginBottom" />
                                    <Text text="à¹„à¸—à¸¢à¹€à¸šà¸Ÿ (à¸šà¸²à¸‡à¸šà¸²à¸¥)" />
                                    <Text text="010025" />
                                    <ObjectNumber number="12,000" unit="kg" />
                                </cells>
                            </ColumnListItem>
                            <ColumnListItem>
                                <cells>
                                    <Text text="FO-2026-0007" />
                                    <Text text="à¹„à¸—à¸¢à¹€à¸šà¸Ÿ (à¸šà¸²à¸‡à¸šà¸²à¸¥)" />
                                    <Text text="010025" />
                                    <ObjectNumber number="10,000" unit="kg" />
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>

                    <VBox id="addedFOSummaryBox" visible="false" class="sapUiSmallMarginTop sapUiContentPadding">
                        <items>
                            <HBox alignItems="Center" class="sapUiTinyMarginBottom">
                                <core:Icon src="sap-icon://accept" color="#107e3e" class="sapUiTinyMarginEnd" />
                                <Label text="âœ“ Consolidated Freight Orders" design="Bold" />
                            </HBox>
                            <VBox id="consolidatedListContainer">
                            </VBox>
                        </items>
                    </VBox>
                </VBox>

                <VBox class="formBox sapUiMediumMarginTop">
                    <HBox alignItems="Center" class="sapUiSmallMarginBottom">
                        <Title text="Shipment Header" level="H4"/>
                    </HBox>

                    <f:SimpleForm backgroundDesign="Transparent" editable="true" layout="ColumnLayout" columnsXL="3" columnsL="3" columnsM="3">
                        <f:content>
                            <Label text="Shipment No." />
                            <Input value="{OrdersD>/editData/shipmentNo}" placeholder="Auto generated" editable="false" />

                            <Label text="Shipment Type" required="true" />
                            <ComboBox value="{OrdersD>/editData/shipmentType}" placeholder="â€” Select â€”" selectedKey="0602" items="{OrdersD>/sections/2/fields/1/options}">
                                <core:Item key="{OrdersD>}" text="{OrdersD>}" />
                            </ComboBox>

                            <Label text="Shipping Type" required="true" />
                            <ComboBox value="{OrdersD>/editData/shippingType}" placeholder="â€” Select â€”" selectedKey="01" items="{OrdersD>/sections/2/fields/2/options}">
                                <core:Item key="{OrdersD>}" text="{OrdersD>}" />
                            </ComboBox>

                            <Label text="Product Type" />
                            <Input value="{OrdersD>/editData/productType}" editable="false" />

                            <Label text="BU / Site" />
                            <Input value="{OrdersD>/editData/buSiteDisplay}" editable="false" />

                            <Label text="Route" required="true" />
                            <ComboBox value="{OrdersD>/editData/routeID}" placeholder="â€” Select Route â€”" change=".onRouteChange" items="{OrdersD>/sections/2/fields/5/options}">
                                <core:Item key="{OrdersD>}" text="{OrdersD>}" />
                            </ComboBox>

                            <Label text="Contract/WBS" required="true" />
                            <Input value="{OrdersD>/editData/wbs}" />

                            <Label text="Contract Date" required="true" />
                            <DatePicker value="{OrdersD>/editData/contractDate}" valueFormat="yyyy-MM-dd" />

                            <Label text="Planned Date/Time" required="true" />
                            <DateTimePicker value="{OrdersD>/editData/plannedDateTime}"/>
                        </f:content>
                    </f:SimpleForm>
                </VBox>

                <VBox class="formBox sapUiMediumMarginTop">
                    <HBox alignItems="Center" justifyContent="SpaceBetween" class="sapUiSmallMarginBottom">
                        <Title text="Vehicle Assignment" level="H4"/>
                        <Button text="ðŸš› Fleet Suggest" type="Emphasized" press=".onFleetSuggest"/>
                    </HBox>
                    <f:SimpleForm backgroundDesign="Transparent" editable="true" layout="ColumnLayout" columnsXL="4" columnsL="4" columnsM="2">
                        <f:content>
                            <Label text="à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸«à¸±à¸§ (Truck Plate)" required="true"/>
                            <Input placeholder="e.g. 83-0569" value="{OrdersD>/editData/truckPlate}" showValueHelp="true" valueHelpRequest=".onTruckValueHelp"/>

                            <Label text="à¸—à¸°à¹€à¸šà¸µà¸¢à¸™à¸žà¹ˆà¸§à¸‡ (Trailer Plate)"/>
                            <Input placeholder="Auto from truck" value="{OrdersD>/editData/trailerPlate}" editable="false"/>

                            <Label text="à¸«à¸¡à¸²à¸¢à¹€à¸¥à¸‚à¸£à¸– (Vehicle No.)"/>
                            <Input placeholder="Or enter vehicle no." value="{OrdersD>/editData/vehicleNo}" showValueHelp="true" valueHelpRequest=".onVehicleValueHelp"/>

                            <Label text="Truck Type"/>
                            <Input placeholder="Auto from lookup" value="{OrdersD>/editData/truckTypeDisplay}" editable="false"/>
                        </f:content>
                    </f:SimpleForm>
                </VBox>

                <VBox class="formBox sapUiMediumMarginTop">
                    <Title text="Drivers &amp; Helpers" level="H4" class="sapUiSmallMarginBottom"/>
                    <Table id="driverTable" inset="false" sticky="ColumnHeaders">
                        <columns>
                            <Column >
                                <Text text="#"/>
                            </Column>
                            <Column>
                                <Text text="Role"/>
                            </Column>
                            <Column >
                                <Text text="Employee ID"/>
                            </Column>
                            <Column>
                                <Text text="Name"/>
                            </Column>
                            <Column>
                                <Text text="Phone"/>
                            </Column>
                            <Column hAlign="Center">
                                <Text text="Intern"/>
                            </Column>
                            <Column hAlign="Center">
                                <Text text="License âœ“"/>
                            </Column>
                        </columns>
                        <items>
                            <ColumnListItem>
                                <cells>
                                    <Text text="1"/>
                                    <ObjectStatus text="à¸žà¸‚à¸£. 1 (Mandatory)" state="Error"/>
                                    <Input showValueHelp="true" placeholder="serach by ID/Name" valueHelpRequest=".onDriverLookup"/>
                                    <Input placeholder="â€” Auto â€”" editable="false"/>
                                    <Input placeholder="Phone"/>
                                    <CheckBox/>
                                    <ObjectStatus text="âœ“ Valid" inverted="true" state="Success"></ObjectStatus>
                                </cells>
                            </ColumnListItem>
                            <ColumnListItem>
                                <cells>
                                    <Text text="2"/>
                                    <ObjectStatus text="à¸žà¸‚à¸£. 2" />
                                    <Input showValueHelp="true" placeholder="optionial" valueHelpRequest=".onDriverLookup"/>
                                    <Input placeholder="â€” Auto â€”" editable="false"/>
                                    <Input placeholder="Phone"/>
                                    <CheckBox/>
                                    <ObjectStatus text="-"></ObjectStatus>
                                </cells>
                            </ColumnListItem>
                            <ColumnListItem>
                                <cells>
                                    <Text text="3"/>
                                    <Text text="à¸žà¸‚à¸£. 3"/>
                                    <Input showValueHelp="true" placeholder="optionial" valueHelpRequest=".onHelperLookup"/>
                                    <Input placeholder="â€” Auto â€”" editable="false"/>
                                    <Input placeholder="Phone"/>
                                    <CheckBox/>
                                    <ObjectStatus text="-"></ObjectStatus>
                                </cells>
                            </ColumnListItem>
                            <ColumnListItem>
                                <cells>
                                    <Text text="4"/>
                                    <Text text="à¸žà¸‚à¸£. 4"/>
                                    <Input showValueHelp="true" placeholder="optionial" valueHelpRequest=".onHelperLookup"/>
                                    <Input placeholder="â€” Auto â€”" editable="false"/>
                                    <Input placeholder="Phone"/>
                                    <CheckBox/>
                                    <ObjectStatus text="-"></ObjectStatus>
                                </cells>
                            </ColumnListItem>
                            <ColumnListItem>
                                <cells>
                                    <Text text="5"/>
                                    <Text text="à¸žà¸•à¸£. 1 (Helper 1)"/>
                                    <Input showValueHelp="true" placeholder="optionial" valueHelpRequest=".onHelperLookup"/>
                                    <Input placeholder="â€” Auto â€”" editable="false"/>
                                    <Input placeholder="Phone"/>
                                    <CheckBox/>
                                    <ObjectStatus text="-"></ObjectStatus>
                                </cells>
                            </ColumnListItem>
                            <ColumnListItem>
                                <cells>
                                    <Text text="6"/>
                                    <Text text="à¸žà¸•à¸£. 2 (Helper 2)"/>
                                    <Input showValueHelp="true" placeholder="optionial" valueHelpRequest=".onHelperLookup"/>
                                    <Input placeholder="â€” Auto â€”" editable="false"/>
                                    <Input placeholder="Phone"/>
                                    <CheckBox/>
                                    <ObjectStatus text="-"></ObjectStatus>
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>
                </VBox>

                <VBox class="formBox sapUiMediumMarginTop">
                    <HBox alignItems="Center" justifyContent="SpaceBetween" class="sapUiSmallMarginBottom">
                        <Title text="Stages &amp; Route Plan" level="H4"/>
                        <ObjectNumber number="311" unit="km" state="Information"/>
                    </HBox>
                    <Table id="stagesTable" inset="false" alternateRowColors="true">
                        <headerToolbar>
                            <OverflowToolbar>
                                <content>
                                    <Label text="ðŸ“ Stages from Route Master. Distance is read-only." />
                                </content>
                            </OverflowToolbar>
                        </headerToolbar>
                        <columns>
                            <Column width="4rem" hAlign="Center">
                                <Text text="Stage"/>
                            </Column>
                            <Column >
                                <Text text="Departure"/>
                            </Column>
                            <Column >
                                <Text text="Destination"/>
                            </Column>
                            <Column width="100px">
                                <Text text="Type"/>
                            </Column>
                            <Column >
                                <Text text="Planned Arrival"/>
                            </Column>
                            <Column >
                                <Text text="Planned Departure"/>
                            </Column>
                            <Column width="80px" hAlign="End">
                                <Text text="Distance"/>
                            </Column>
                            <Column width="100px" hAlign="Center">
                                <Text text="Actions"/>
                            </Column>
                        </columns>
                        <items>
                            <ColumnListItem>
                                <cells>
                                    <ObjectStatus text="0" state="Information" inverted="true" />
                                    <VBox>
                                        <Text text="â€”" />
                                        <Text text="â€”" class="sapUiTinyMarginTop"/>
                                    </VBox>
                                    <VBox>
                                        <Text text="à¸—à¹ˆà¸²à¹€à¸£à¸·à¸­à¸šà¸²à¸‡à¸›à¸°à¸à¸‡" />
                                        <Text text="010007" class="sapUiTinyMarginTop"/>
                                    </VBox>
                                    <ObjectStatus text="First" state="None" />
                                    <DateTimePicker />
                                    <DateTimePicker />
                                    <Text text="â€”" />
                                    <HBox justifyContent="Center">
                                        <Button icon="sap-icon://notes" type="Transparent" press=".onReportIn" tooltip="Report-In" visible="false"/>
                                    </HBox>
                                </cells>
                            </ColumnListItem>

                            <ColumnListItem>
                                <cells>
                                    <ObjectStatus text="1" state="Warning" inverted="true" />
                                    <VBox>
                                        <Text text="à¸—à¹ˆà¸²à¹€à¸£à¸·à¸­à¸šà¸²à¸‡à¸›à¸°à¸à¸‡" />
                                        <Text text="010007" />
                                    </VBox>
                                    <VBox>
                                        <Text text="à¹„à¸—à¸¢à¹€à¸šà¸Ÿ (à¸šà¸²à¸‡à¸šà¸²à¸¥)" />
                                        <Text text="010025" />
                                    </VBox>
                                    <ObjectStatus text="Transport" state="Warning" />
                                    <DateTimePicker />
                                    <DateTimePicker />
                                    <Text text="151 km" />
                                    <HBox>
                                        <Button icon="sap-icon://navigation-up-arrow" press=".onSwapStage" />
                                        <Button icon="sap-icon://navigation-down-arrow" press=".onSwapStage" />
                                    </HBox>
                                </cells>
                            </ColumnListItem>

                            <ColumnListItem>
                                <cells>
                                    <ObjectStatus text="2" state="Success" inverted="true" />
                                    <VBox>
                                        <Text text="à¹„à¸—à¸¢à¹€à¸šà¸Ÿ (à¸šà¸²à¸‡à¸šà¸²à¸¥)" />
                                        <Text text="010025" />
                                    </VBox>
                                    <VBox>
                                        <Text text="à¸—à¹ˆà¸²à¹€à¸£à¸·à¸­à¸šà¸²à¸‡à¸›à¸°à¸à¸‡" />
                                        <Text text="010007" />
                                    </VBox>
                                    <ObjectStatus text="Loading Transfer" state="Success" />
                                    <DateTimePicker />
                                    <DateTimePicker />
                                    <Text text="160 km" />
                                    <HBox>
                                        <Button icon="sap-icon://navigation-up-arrow" press=".onSwapStage" />
                                        <Button icon="sap-icon://navigation-down-arrow" press=".onSwapStage" />
                                    </HBox>
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>
                    <HBox justifyContent="SpaceBetween" alignItems="Center" class="sapUiSmallMarginTop">
                        <Button text="Add Stage" icon="sap-icon://add" press=".onAddStage" />
                        <HBox alignItems="Center">
                            <Label text="Total Distance:" class="sapUiSmallMarginEnd" />
                            <Title text="316 km" titleStyle="H3" />
                        </HBox>
                    </HBox>
                </VBox>

                <VBox class="formBox sapUiMediumMarginTop sapUiLargeMarginBottom">
                    <Title text="Transport Fee &amp; Trip Pay" level="H4" class="sapUiSmallMarginBottom"/>
                    <f:SimpleForm backgroundDesign="Transparent" editable="true" layout="ColumnLayout" columnsXL="3" columnsL="3" columnsM="1">
                        <f:content>
                            <Label text="à¸„à¹ˆà¸²à¸‚à¸™à¸ªà¹ˆà¸‡ (Transport Fee)"/>
                            <ComboBox items="{OrdersD>/sections/6/fields/0/options}" value="{OrdersD>/editData/transportFee}" selectedKey="à¹€à¸à¹‡à¸š">
                                <core:Item key="{OrdersD>}" text="{OrdersD>}"/>
                            </ComboBox>

                            <Label text="à¸„à¹ˆà¸²à¹€à¸—à¸µà¹ˆà¸¢à¸§ (Trip Pay)"/>
                            <ComboBox items="{OrdersD>/sections/6/fields/1/options}" value="{OrdersD>/editData/tripPay}" selectedKey="à¸ˆà¹ˆà¸²à¸¢">
                                <core:Item key="{OrdersD>}" text="{OrdersD>}"/>
                            </ComboBox>

                            <Label text="Validation"/>
                            <CheckBox selected="{OrdersD>/editData/brokenMiles}" text="à¹„à¸¡à¹ˆà¸„à¸´à¸”à¹€à¸ªà¸µà¸¢ (Broken Miles) â€” If checked, validates with broken miles criteria (config 004, 005)"/>
                        </f:content>
                    </f:SimpleForm>
                </VBox>
            </VBox>
        </content>

        <beginButton>
            <Button text="Cancel" press=".onCloseFleetCockpit"/>
        </beginButton>
        <endButton>
            <Button text="Confirm Assignment" type="Accept" press=".onConformpres"/>
        </endButton>


    </Dialog>
</core:FragmentDefinition>
